"use strict";(self.webpackChunkpodman=self.webpackChunkpodman||[]).push([[6982],{3905:(e,t,n)=>{n.d(t,{Zo:()=>m,kt:()=>c});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=a.createContext({}),p=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},m=function(e){var t=p(e.components);return a.createElement(l.Provider,{value:t},e.children)},u="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},h=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,m=s(e,["components","mdxType","originalType","parentName"]),u=p(n),h=i,c=u["".concat(l,".").concat(h)]||u[h]||d[h]||o;return n?a.createElement(c,r(r({ref:t},m),{},{components:n})):a.createElement(c,r({ref:t},m))}));function c(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,r=new Array(o);r[0]=h;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[u]="string"==typeof e?e:i,r[1]=s;for(var p=2;p<o;p++)r[p]=n[p];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}h.displayName="MDXCreateElement"},9154:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>d,frontMatter:()=>o,metadata:()=>s,toc:()=>p});var a=n(7462),i=(n(7294),n(3905));const o={},r=void 0,s={unversionedId:"podman-build",id:"podman-build",title:"podman-build",description:"% podman-build 1",source:"@site/docs/podman-build.md",sourceDirName:".",slug:"/podman-build",permalink:"/websites-new/docs/podman-build",draft:!1,editUrl:"https://github.com/containers/website-new/docs/podman-build.md",tags:[],version:"current",frontMatter:{},sidebar:"docsSidebar",previous:{title:"podman-auto-update",permalink:"/websites-new/docs/podman-auto-update"},next:{title:"podman-commit",permalink:"/websites-new/docs/podman-commit"}},l={},p=[{value:"NAME",id:"name",level:2},{value:"SYNOPSIS",id:"synopsis",level:2},{value:"DESCRIPTION",id:"description",level:2},{value:"OPTIONS",id:"options",level:2},{value:"<strong>--all-platforms</strong>",id:"--all-platforms",level:4},{value:"<strong>--annotation</strong>=<em>annotation</em>",id:"--annotationannotation",level:4},{value:"<strong>--arch</strong>=<em>arch</em>",id:"--archarch",level:4},{value:"<strong>--build-arg</strong>=<em>arg=value</em>",id:"--build-argargvalue",level:4},{value:"<strong>--build-arg-file</strong>=<em>path</em>",id:"--build-arg-filepath",level:4},{value:"<strong>--build-context</strong>=<em>name=value</em>",id:"--build-contextnamevalue",level:4},{value:"<strong>--cache-from</strong>",id:"--cache-from",level:4},{value:"<strong>--cache-to</strong>",id:"--cache-to",level:4},{value:"<strong>--cache-ttl</strong>",id:"--cache-ttl",level:4},{value:"<strong>--cap-add</strong>=<em>CAP_xxx</em>",id:"--cap-addcap_xxx",level:4},{value:"<strong>--cap-drop</strong>=<em>CAP_xxx</em>",id:"--cap-dropcap_xxx",level:4},{value:"<strong>--cgroupns</strong>=<em>how</em>",id:"--cgroupnshow",level:4},{value:"<strong>--compress</strong>",id:"--compress",level:4},{value:"<strong>--cpp-flag</strong>=<em>flags</em>",id:"--cpp-flagflags",level:4},{value:"<strong>--decryption-key</strong>=<em>key:passphrase</em>",id:"--decryption-keykeypassphrase",level:4},{value:"<strong>--disable-compression</strong>, <strong>-D</strong>",id:"--disable-compression--d",level:4},{value:"<strong>--dns-option</strong>=<em>option</em>",id:"--dns-optionoption",level:4},{value:"<strong>--dns-search</strong>=<em>domain</em>",id:"--dns-searchdomain",level:4},{value:"<strong>--env</strong>=<em>env=value</em>",id:"--envenvvalue",level:4},{value:"<strong>--file</strong>, <strong>-f</strong>=<em>Containerfile</em>",id:"--file--fcontainerfile",level:4},{value:"<strong>--force-rm</strong>",id:"--force-rm",level:4},{value:"<strong>--format</strong>",id:"--format",level:4},{value:"<strong>--from</strong>",id:"--from",level:4},{value:"<strong>--group-add</strong>=<em>group</em> | <em>keep-groups</em>",id:"--group-addgroup--keep-groups",level:4},{value:"<strong>--help</strong>, <strong>-h</strong>",id:"--help--h",level:4},{value:"<strong>--hooks-dir</strong>=<em>path</em>",id:"--hooks-dirpath",level:4},{value:"<strong>--identity-label</strong>",id:"--identity-label",level:4},{value:"<strong>--ignorefile</strong>",id:"--ignorefile",level:4},{value:"<strong>--iidfile</strong>=<em>ImageIDfile</em>",id:"--iidfileimageidfile",level:4},{value:"<strong>--ipc</strong>=<em>how</em>",id:"--ipchow",level:4},{value:"<strong>--isolation</strong>=<em>type</em>",id:"--isolationtype",level:4},{value:"<strong>--jobs</strong>=<em>number</em>",id:"--jobsnumber",level:4},{value:"<strong>--label</strong>=<em>label</em>",id:"--labellabel",level:4},{value:"<strong>--layers</strong>",id:"--layers",level:4},{value:"<strong>--logfile</strong>=<em>filename</em>",id:"--logfilefilename",level:4},{value:"<strong>--logsplit</strong>=<em>bool-value</em>",id:"--logsplitbool-value",level:4},{value:"<strong>--manifest</strong>=<em>manifest</em>",id:"--manifestmanifest",level:4},{value:"<strong>--network</strong>=<em>mode</em>, <strong>--net</strong>",id:"--networkmode---net",level:4},{value:"<strong>--no-cache</strong>",id:"--no-cache",level:4},{value:"<strong>--omit-history</strong>",id:"--omit-history",level:4},{value:"<strong>--os</strong>=<em>string</em>",id:"--osstring",level:4},{value:"<strong>--os-feature</strong>=<em>feature</em>",id:"--os-featurefeature",level:4},{value:"<strong>--os-version</strong>=<em>version</em>",id:"--os-versionversion",level:4},{value:"<strong>--output</strong>, <strong>-o</strong>=<em>output-opts</em>",id:"--output--ooutput-opts",level:4},{value:"<strong>--pid</strong>=<em>pid</em>",id:"--pidpid",level:4},{value:"<strong>--platform</strong>=<em>os/arch/variant</em>",id:"--platformosarchvariant",level:4},{value:"<strong>--pull</strong>=<em>policy</em>",id:"--pullpolicy",level:4},{value:"<strong>--quiet</strong>, <strong>-q</strong>",id:"--quiet--q",level:4},{value:"<strong>--retry</strong>=<em>attempts</em>",id:"--retryattempts",level:4},{value:"<strong>--retry-delay</strong>=<em>duration</em>",id:"--retry-delayduration",level:4},{value:"<strong>--rm</strong>",id:"--rm",level:4},{value:"<strong>--runtime</strong>=<em>path</em>",id:"--runtimepath",level:4},{value:"<strong>--runtime-flag</strong>=<em>flag</em>",id:"--runtime-flagflag",level:4},{value:"<strong>--secret</strong>=<strong>id=id,src=path</strong>",id:"--secretididsrcpath",level:4},{value:"<strong>--security-opt</strong>=<em>option</em>",id:"--security-optoption",level:4},{value:"<strong>--sign-by</strong>=<em>fingerprint</em>",id:"--sign-byfingerprint",level:4},{value:"<strong>--skip-unused-stages</strong>",id:"--skip-unused-stages",level:4},{value:"<strong>--squash</strong>",id:"--squash",level:4},{value:"<strong>--squash-all</strong>",id:"--squash-all",level:4},{value:"<strong>--ssh</strong>=<em>default</em> | <em>id[=socket&gt;</em>",id:"--sshdefault--idsocket",level:4},{value:"<strong>--stdin</strong>",id:"--stdin",level:4},{value:"<strong>--tag</strong>, <strong>-t</strong>=<em>imageName</em>",id:"--tag--timagename",level:4},{value:"<strong>--target</strong>=<em>stageName</em>",id:"--targetstagename",level:4},{value:"<strong>--timestamp</strong>=<em>seconds</em>",id:"--timestampseconds",level:4},{value:"<strong>--ulimit</strong>=<em>type=soft-limit:hard-limit</em>",id:"--ulimittypesoft-limithard-limit",level:4},{value:"<strong>--unsetenv</strong>=<em>env</em>",id:"--unsetenvenv",level:4},{value:"<strong>--userns</strong>=<em>how</em>",id:"--usernshow",level:4},{value:"<strong>--userns-gid-map</strong>=<em>mapping</em>",id:"--userns-gid-mapmapping",level:4},{value:"<strong>--userns-gid-map-group</strong>=<em>group</em>",id:"--userns-gid-map-groupgroup",level:4},{value:"<strong>--userns-uid-map</strong>=<em>mapping</em>",id:"--userns-uid-mapmapping",level:4},{value:"<strong>--userns-uid-map-user</strong>=<em>user</em>",id:"--userns-uid-map-useruser",level:4},{value:"<strong>--uts</strong>=<em>how</em>",id:"--utshow",level:4},{value:"<strong>--variant</strong>=<em>variant</em>",id:"--variantvariant",level:4},{value:"<strong>--volume</strong>, <strong>-v</strong>=<em>[HOST-DIR:CONTAINER-DIR:OPTIONS]</em>",id:"--volume--vhost-dircontainer-diroptions",level:4},{value:"EXAMPLES",id:"examples",level:2},{value:"Build an image using local Containerfiles",id:"build-an-image-using-local-containerfiles",level:3},{value:"Building a multi-architecture image using the --manifest option (requires emulation software)",id:"building-a-multi-architecture-image-using-the---manifest-option-requires-emulation-software",level:3},{value:"Building an image using a URL, Git repo, or archive",id:"building-an-image-using-a-url-git-repo-or-archive",level:3},{value:"Building an image using a URL to a Containerfile",id:"building-an-image-using-a-url-to-a-containerfile",level:4},{value:"Building an image using a Git repository",id:"building-an-image-using-a-git-repository",level:4},{value:"Building an image using a URL to an archive",id:"building-an-image-using-a-url-to-an-archive",level:4},{value:"Files",id:"files",level:2},{value:".containerignore/.dockerignore",id:"containerignoredockerignore",level:3},{value:"Troubleshooting",id:"troubleshooting",level:2},{value:"lastlog sparse file",id:"lastlog-sparse-file",level:3},{value:"SEE ALSO",id:"see-also",level:2},{value:"HISTORY",id:"history",level:2},{value:"FOOTNOTES",id:"footnotes",level:2}],m={toc:p},u="wrapper";function d(e){let{components:t,...n}=e;return(0,i.kt)(u,(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"% podman-build 1"),(0,i.kt)("h2",{id:"name"},"NAME"),(0,i.kt)("p",null,"podman","-","build - Build a container image using a Containerfile"),(0,i.kt)("h2",{id:"synopsis"},"SYNOPSIS"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"podman build")," ","[",(0,i.kt)("em",{parentName:"p"},"options"),"][*context*]"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"podman image build")," ","[",(0,i.kt)("em",{parentName:"p"},"options"),"][*context*]"),(0,i.kt)("h2",{id:"description"},"DESCRIPTION"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"podman build")," Builds an image using instructions from one or more\nContainerfiles or Dockerfiles and a specified build context directory. A\nContainerfile uses the same syntax as a Dockerfile internally. For this\ndocument, a file referred to as a Containerfile can be a file named\neither 'Containerfile' or 'Dockerfile'."),(0,i.kt)("p",null,"The build context directory can be specified as the http(s) URL of an archive,\ngit repository or Containerfile."),(0,i.kt)("p",null,"When invoked with ",(0,i.kt)("inlineCode",{parentName:"p"},"-f")," and a path to a Containerfile, with no explicit CONTEXT\ndirectory, Podman will use the Containerfile's parent directory as its build context."),(0,i.kt)("p",null,'Containerfiles ending with a ".in" suffix will be preprocessed via CPP(1). This\ncan be useful to decompose Containerfiles into several reusable parts that can\nbe used via CPP\'s ',(0,i.kt)("strong",{parentName:"p"},"#include")," directive. Notice, a Containerfile.in file can\nstill be used by other tools when manually preprocessing them via ",(0,i.kt)("inlineCode",{parentName:"p"},"cpp -E"),"."),(0,i.kt)("p",null,"When the URL is an archive, the contents of the URL is downloaded to a temporary\nlocation and extracted before execution."),(0,i.kt)("p",null,"When the URL is a Containerfile, the Containerfile is downloaded to a temporary\nlocation."),(0,i.kt)("p",null,"When a Git repository is set as the URL, the repository is cloned locally and\nthen set as the context."),(0,i.kt)("p",null,"NOTE: ",(0,i.kt)("inlineCode",{parentName:"p"},"podman build")," uses code sourced from the ",(0,i.kt)("inlineCode",{parentName:"p"},"Buildah")," project to build\ncontainer images. This ",(0,i.kt)("inlineCode",{parentName:"p"},"Buildah")," code creates ",(0,i.kt)("inlineCode",{parentName:"p"},"Buildah")," containers for the\n",(0,i.kt)("inlineCode",{parentName:"p"},"RUN")," options in container storage. In certain situations, when the\n",(0,i.kt)("inlineCode",{parentName:"p"},"podman build")," crashes or users kill the ",(0,i.kt)("inlineCode",{parentName:"p"},"podman build")," process, these external\ncontainers can be left in container storage. Use the ",(0,i.kt)("inlineCode",{parentName:"p"},"podman ps --all --storage"),"\ncommand to see these containers. External containers can be removed with the\n",(0,i.kt)("inlineCode",{parentName:"p"},"podman rm --storage")," command."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"podman buildx build")," command is an alias of ",(0,i.kt)("inlineCode",{parentName:"p"},"podman build"),". Not all ",(0,i.kt)("inlineCode",{parentName:"p"},"buildx build")," features are available in Podman. The ",(0,i.kt)("inlineCode",{parentName:"p"},"buildx build")," option is provided for scripting compatibility."),(0,i.kt)("h2",{id:"options"},"OPTIONS"),(0,i.kt)("p",null,"@@option add-host"),(0,i.kt)("h4",{id:"--all-platforms"},(0,i.kt)("strong",{parentName:"h4"},"--all-platforms")),(0,i.kt)("p",null,"Instead of building for a set of platforms specified using the ",(0,i.kt)("strong",{parentName:"p"},"--platform")," option, inspect the build's base images, and build for all of the platforms for which they are all available. Stages that use ",(0,i.kt)("em",{parentName:"p"},"scratch")," as a starting point can not be inspected, so at least one non-",(0,i.kt)("em",{parentName:"p"},"scratch")," stage must be present for detection to work usefully."),(0,i.kt)("h4",{id:"--annotationannotation"},(0,i.kt)("strong",{parentName:"h4"},"--annotation"),"=",(0,i.kt)("em",{parentName:"h4"},"annotation")),(0,i.kt)("p",null,"Add an image ",(0,i.kt)("em",{parentName:"p"},"annotation")," (e.g. annotation=",(0,i.kt)("em",{parentName:"p"},"value"),") to the image metadata. Can\nbe used multiple times."),(0,i.kt)("p",null,"Note: this information is not present in Docker image formats, so it is\ndiscarded when writing images in Docker formats."),(0,i.kt)("h4",{id:"--archarch"},(0,i.kt)("strong",{parentName:"h4"},"--arch"),"=",(0,i.kt)("em",{parentName:"h4"},"arch")),(0,i.kt)("p",null,"Set the architecture of the image to be built, and that of the base image to be\npulled, if the build uses one, to the provided value instead of using the\narchitecture of the build host. Unless overridden, subsequent lookups of the\nsame image in the local storage will match this architecture, regardless of the\nhost. (Examples: arm, arm64, 386, amd64, ppc64le, s390x)"),(0,i.kt)("p",null,"@@option authfile"),(0,i.kt)("h4",{id:"--build-argargvalue"},(0,i.kt)("strong",{parentName:"h4"},"--build-arg"),"=",(0,i.kt)("em",{parentName:"h4"},"arg=value")),(0,i.kt)("p",null,"Specifies a build argument and its value, which will be interpolated in\ninstructions read from the Containerfiles in the same way that environment\nvariables are, but which will not be added to environment variable list in the\nresulting image's configuration."),(0,i.kt)("h4",{id:"--build-arg-filepath"},(0,i.kt)("strong",{parentName:"h4"},"--build-arg-file"),"=",(0,i.kt)("em",{parentName:"h4"},"path")),(0,i.kt)("p",null,"Specifies a file containing lines of build arguments of the form ",(0,i.kt)("inlineCode",{parentName:"p"},"arg=value"),".\nThe suggested file name is ",(0,i.kt)("inlineCode",{parentName:"p"},"argfile.conf"),"."),(0,i.kt)("p",null,"Comment lines beginning with ",(0,i.kt)("inlineCode",{parentName:"p"},"#")," are ignored, along with blank lines.\nAll others should be of the ",(0,i.kt)("inlineCode",{parentName:"p"},"arg=value")," format passed to ",(0,i.kt)("inlineCode",{parentName:"p"},"--build-arg"),"."),(0,i.kt)("p",null,"If several arguments are provided via the ",(0,i.kt)("inlineCode",{parentName:"p"},"--build-arg-file"),"\nand ",(0,i.kt)("inlineCode",{parentName:"p"},"--build-arg")," options, the build arguments will be merged across all\nof the provided files and command line arguments."),(0,i.kt)("p",null,"Any file provided in a ",(0,i.kt)("inlineCode",{parentName:"p"},"--build-arg-file")," option will be read before\nthe arguments supplied via the ",(0,i.kt)("inlineCode",{parentName:"p"},"--build-arg")," option."),(0,i.kt)("p",null,"When a given argument name is specified several times, the last instance\nis the one that is passed to the resulting builds. This means ",(0,i.kt)("inlineCode",{parentName:"p"},"--build-arg"),"\nvalues always override those in a ",(0,i.kt)("inlineCode",{parentName:"p"},"--build-arg-file"),"."),(0,i.kt)("h4",{id:"--build-contextnamevalue"},(0,i.kt)("strong",{parentName:"h4"},"--build-context"),"=",(0,i.kt)("em",{parentName:"h4"},"name=value")),(0,i.kt)("p",null,"Specify an additional build context using its short name and its location.\nAdditional build contexts can be referenced in the same manner as we access\ndifferent stages in COPY instruction."),(0,i.kt)("p",null,"Valid values could be:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Local directory \u2013 e.g. --build-context project2=../path/to/project2/src (This option is not available with the remote Podman client. On Podman machine setup (i.e macOS and Winows) path must exists on the machine VM)"),(0,i.kt)("li",{parentName:"ul"},"HTTP URL to a tarball \u2013 e.g. --build-context src=",(0,i.kt)("a",{parentName:"li",href:"https://example.org/releases/src.tar"},"https://example.org/releases/src.tar")),(0,i.kt)("li",{parentName:"ul"},"Container image \u2013 specified with a container-image:// prefix, e.g. --build-context alpine=container-image://alpine:35, (also accepts docker://, docker-image://)")),(0,i.kt)("p",null,"On the Containerfile side, reference the build context on all\ncommands that accept the \u201cfrom\u201d parameter. Here\u2019s how that might look:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-dockerfile"},"FROM [name]\nCOPY --from=[name] ...\nRUN --mount=from=[name] \u2026\n")),(0,i.kt)("p",null,"The value of ","[name]"," is matched with the following priority order:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Named build context defined with --build-context ","[name]","=.."),(0,i.kt)("li",{parentName:"ul"},"Stage defined with AS ","[name]"," inside Containerfile"),(0,i.kt)("li",{parentName:"ul"},"Image ","[name]",", either local or in a remote registry")),(0,i.kt)("h4",{id:"--cache-from"},(0,i.kt)("strong",{parentName:"h4"},"--cache-from")),(0,i.kt)("p",null,"Repository to utilize as a potential cache source. When specified, Buildah will try to look for\ncache images in the specified repository and will attempt to pull cache images instead of actually\nexecuting the build steps locally. Buildah will only attempt to pull previously cached images if they\nare considered as valid cache hits."),(0,i.kt)("p",null,"Use the ",(0,i.kt)("inlineCode",{parentName:"p"},"--cache-to")," option to populate a remote repository with cache content."),(0,i.kt)("p",null,"Example"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"# populate a cache and also consult it\nbuildah build -t test --layers --cache-to registry/myrepo/cache --cache-from registry/myrepo/cache .\n")),(0,i.kt)("p",null,"Note: ",(0,i.kt)("inlineCode",{parentName:"p"},"--cache-from")," option is ignored unless ",(0,i.kt)("inlineCode",{parentName:"p"},"--layers")," is specified."),(0,i.kt)("h4",{id:"--cache-to"},(0,i.kt)("strong",{parentName:"h4"},"--cache-to")),(0,i.kt)("p",null,"Set this flag to specify a remote repository that will be used to store cache images. Buildah will attempt to\npush newly built cache image to the remote repository."),(0,i.kt)("p",null,"Note: Use the ",(0,i.kt)("inlineCode",{parentName:"p"},"--cache-from")," option in order to use cache content in a remote repository."),(0,i.kt)("p",null,"Example"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-bash"},"# populate a cache and also consult it\nbuildah build -t test --layers --cache-to registry/myrepo/cache --cache-from registry/myrepo/cache .\n")),(0,i.kt)("p",null,"Note: ",(0,i.kt)("inlineCode",{parentName:"p"},"--cache-to")," option is ignored unless ",(0,i.kt)("inlineCode",{parentName:"p"},"--layers")," is specified."),(0,i.kt)("h4",{id:"--cache-ttl"},(0,i.kt)("strong",{parentName:"h4"},"--cache-ttl")),(0,i.kt)("p",null,"Limit the use of cached images to only consider images with created timestamps less than ",(0,i.kt)("em",{parentName:"p"},"duration")," ago.\nFor example if ",(0,i.kt)("inlineCode",{parentName:"p"},"--cache-ttl=1h")," is specified, Buildah will only consider intermediate cache images which are created\nunder the duration of one hour, and intermediate cache images outside this duration will be ignored."),(0,i.kt)("p",null,"Note: Setting ",(0,i.kt)("inlineCode",{parentName:"p"},"--cache-ttl=0")," manually is equivalent to using ",(0,i.kt)("inlineCode",{parentName:"p"},"--no-cache")," in the\nimplementation since this would effectively mean that user is not willing to use\ncache at all."),(0,i.kt)("h4",{id:"--cap-addcap_xxx"},(0,i.kt)("strong",{parentName:"h4"},"--cap-add"),"=",(0,i.kt)("em",{parentName:"h4"},"CAP_xxx")),(0,i.kt)("p",null,"When executing RUN instructions, run the command specified in the instruction\nwith the specified capability added to its capability set.\nCertain capabilities are granted by default; this option can be used to add\nmore."),(0,i.kt)("h4",{id:"--cap-dropcap_xxx"},(0,i.kt)("strong",{parentName:"h4"},"--cap-drop"),"=",(0,i.kt)("em",{parentName:"h4"},"CAP_xxx")),(0,i.kt)("p",null,"When executing RUN instructions, run the command specified in the instruction\nwith the specified capability removed from its capability set.\nThe CAP_CHOWN, CAP_DAC_OVERRIDE, CAP_FOWNER,\nCAP_FSETID, CAP_KILL, CAP_NET_BIND_SERVICE, CAP_SETFCAP,\nCAP_SETGID, CAP_SETPCAP, and CAP_SETUID capabilities are\ngranted by default; this option can be used to remove them."),(0,i.kt)("p",null,"If a capability is specified to both the ",(0,i.kt)("strong",{parentName:"p"},"--cap-add")," and ",(0,i.kt)("strong",{parentName:"p"},"--cap-drop"),"\noptions, it will be dropped, regardless of the order in which the options were\ngiven."),(0,i.kt)("p",null,"@@option cert-dir"),(0,i.kt)("p",null,"@@option cgroup-parent"),(0,i.kt)("h4",{id:"--cgroupnshow"},(0,i.kt)("strong",{parentName:"h4"},"--cgroupns"),"=",(0,i.kt)("em",{parentName:"h4"},"how")),(0,i.kt)("p",null,"Sets the configuration for cgroup namespaces when handling ",(0,i.kt)("inlineCode",{parentName:"p"},"RUN"),' instructions.\nThe configured value can be "" (the empty string) or "private" to indicate\nthat a new cgroup namespace should be created, or it can be "host" to indicate\nthat the cgroup namespace in which ',(0,i.kt)("inlineCode",{parentName:"p"},"buildah")," itself is being run should be reused."),(0,i.kt)("h4",{id:"--compress"},(0,i.kt)("strong",{parentName:"h4"},"--compress")),(0,i.kt)("p",null,"This option is added to be aligned with other containers CLIs.\nPodman doesn't communicate with a daemon or a remote server.\nThus, compressing the data before sending it is irrelevant to Podman. (This option is not available with the remote Podman client, including Mac and Windows (excluding WSL2) machines)"),(0,i.kt)("h4",{id:"--cpp-flagflags"},(0,i.kt)("strong",{parentName:"h4"},"--cpp-flag"),"=",(0,i.kt)("em",{parentName:"h4"},"flags")),(0,i.kt)("p",null,'Set additional flags to pass to the C Preprocessor cpp(1). Containerfiles ending with a ".in" suffix will be preprocessed via cpp(1). This option can be used to pass additional flags to cpp.Note: You can also set default CPPFLAGS by setting the BUILDAH_CPPFLAGS environment variable (e.g., export BUILDAH_CPPFLAGS="-DDEBUG").'),(0,i.kt)("p",null,"@@option cpu-period"),(0,i.kt)("p",null,"@@option cpu-quota"),(0,i.kt)("p",null,"@@option cpu-shares"),(0,i.kt)("p",null,"@@option cpuset-cpus"),(0,i.kt)("p",null,"@@option cpuset-mems"),(0,i.kt)("p",null,"@@option creds"),(0,i.kt)("h4",{id:"--decryption-keykeypassphrase"},(0,i.kt)("strong",{parentName:"h4"},"--decryption-key"),"=",(0,i.kt)("em",{parentName:"h4"},"key","[:passphrase]")),(0,i.kt)("p",null,"The [key","[:passphrase]","] to be used for decryption of images. Key can point to\nkeys and/or certificates. Decryption will be tried with all keys. If the key is\nprotected by a passphrase, it is required to be passed in the argument and\nomitted otherwise."),(0,i.kt)("p",null,"@@option device"),(0,i.kt)("p",null,"Note: if the user only has access rights via a group, accessing the device\nfrom inside a rootless container will fail. The ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"https://github.com/containers/crun/tree/main/crun.md"},"crun(1)"))," runtime offers a\nworkaround for this by adding the option\n",(0,i.kt)("strong",{parentName:"p"},"--annotation run.oci.keep_original_groups=1"),"."),(0,i.kt)("h4",{id:"--disable-compression--d"},(0,i.kt)("strong",{parentName:"h4"},"--disable-compression"),", ",(0,i.kt)("strong",{parentName:"h4"},"-D")),(0,i.kt)("p",null,"Don't compress filesystem layers when building the image unless it is required\nby the location where the image is being written. This is the default setting,\nbecause image layers are compressed automatically when they are pushed to\nregistries, and images being written to local storage would only need to be\ndecompressed again to be stored. Compression can be forced in all cases by\nspecifying ",(0,i.kt)("strong",{parentName:"p"},"--disable-compression=false"),"."),(0,i.kt)("p",null,"@@option disable-content-trust"),(0,i.kt)("p",null,"@@option dns"),(0,i.kt)("p",null,"This option cannot be combined with ",(0,i.kt)("strong",{parentName:"p"},"--network")," that is set to ",(0,i.kt)("strong",{parentName:"p"},"none"),"."),(0,i.kt)("p",null,"Note: this option takes effect only during ",(0,i.kt)("em",{parentName:"p"},"RUN")," instructions in the build.\nIt does not affect ",(0,i.kt)("em",{parentName:"p"},"/etc/resolv.conf")," in the final image."),(0,i.kt)("h4",{id:"--dns-optionoption"},(0,i.kt)("strong",{parentName:"h4"},"--dns-option"),"=",(0,i.kt)("em",{parentName:"h4"},"option")),(0,i.kt)("p",null,"Set custom DNS options to be used during the build."),(0,i.kt)("h4",{id:"--dns-searchdomain"},(0,i.kt)("strong",{parentName:"h4"},"--dns-search"),"=",(0,i.kt)("em",{parentName:"h4"},"domain")),(0,i.kt)("p",null,"Set custom DNS search domains to be used during the build."),(0,i.kt)("h4",{id:"--envenvvalue"},(0,i.kt)("strong",{parentName:"h4"},"--env"),"=",(0,i.kt)("em",{parentName:"h4"},"env","[=value]")),(0,i.kt)("p",null,"Add a value (e.g. env=",(0,i.kt)("em",{parentName:"p"},"value"),") to the built image. Can be used multiple times.\nIf neither ",(0,i.kt)("inlineCode",{parentName:"p"},"=")," nor a ",(0,i.kt)("inlineCode",{parentName:"p"},"*value*")," are specified, but ",(0,i.kt)("em",{parentName:"p"},"env")," is set in the current\nenvironment, the value from the current environment will be added to the image.\nTo remove an environment variable from the built image, use the ",(0,i.kt)("inlineCode",{parentName:"p"},"--unsetenv"),"\noption."),(0,i.kt)("h4",{id:"--file--fcontainerfile"},(0,i.kt)("strong",{parentName:"h4"},"--file"),", ",(0,i.kt)("strong",{parentName:"h4"},"-f"),"=",(0,i.kt)("em",{parentName:"h4"},"Containerfile")),(0,i.kt)("p",null,"Specifies a Containerfile which contains instructions for building the image,\neither a local file or an ",(0,i.kt)("strong",{parentName:"p"},"http")," or ",(0,i.kt)("strong",{parentName:"p"},"https")," URL. If more than one\nContainerfile is specified, ",(0,i.kt)("em",{parentName:"p"},"FROM")," instructions will only be accepted from the\nlast specified file."),(0,i.kt)("p",null,"If a build context is not specified, and at least one Containerfile is a\nlocal file, the directory in which it resides will be used as the build\ncontext."),(0,i.kt)("p",null,"Specifying the option ",(0,i.kt)("inlineCode",{parentName:"p"},"-f -")," causes the Containerfile contents to be read from stdin."),(0,i.kt)("h4",{id:"--force-rm"},(0,i.kt)("strong",{parentName:"h4"},"--force-rm")),(0,i.kt)("p",null,"Always remove intermediate containers after a build, even if the build fails\n(default true)."),(0,i.kt)("h4",{id:"--format"},(0,i.kt)("strong",{parentName:"h4"},"--format")),(0,i.kt)("p",null,"Control the format for the built image's manifest and configuration data.\nRecognized formats include ",(0,i.kt)("em",{parentName:"p"},"oci")," (OCI image-spec v1.0, the default) and\n",(0,i.kt)("em",{parentName:"p"},"docker")," (version 2, using schema format 2 for the manifest)."),(0,i.kt)("p",null,"Note: You can also override the default format by setting the BUILDAH_FORMAT\nenvironment variable. ",(0,i.kt)("inlineCode",{parentName:"p"},"export BUILDAH_FORMAT=docker")),(0,i.kt)("h4",{id:"--from"},(0,i.kt)("strong",{parentName:"h4"},"--from")),(0,i.kt)("p",null,"Overrides the first ",(0,i.kt)("inlineCode",{parentName:"p"},"FROM")," instruction within the Containerfile. If there are multiple\nFROM instructions in a Containerfile, only the first is changed."),(0,i.kt)("p",null,"With the remote podman client, not all container transports will work as\nexpected. For example, oci-archive:/x.tar will reference /x.tar on the remote\nmachine instead of on the client. When using podman remote clients it is\nbest to restrict use to ",(0,i.kt)("em",{parentName:"p"},"containers-storage"),", and ",(0,i.kt)("em",{parentName:"p"},"docker:// transports"),"."),(0,i.kt)("h4",{id:"--group-addgroup--keep-groups"},(0,i.kt)("strong",{parentName:"h4"},"--group-add"),"=",(0,i.kt)("em",{parentName:"h4"},"group")," | ",(0,i.kt)("em",{parentName:"h4"},"keep-groups")),(0,i.kt)("p",null,"Assign additional groups to the primary user running within the container\nprocess."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"keep-groups")," is a special value that tells Buildah to keep the supplementary\ngroup access.")),(0,i.kt)("p",null,"Allows container to use the user's supplementary group access. If file systems\nor devices are only accessible by the rootless user's group, this flag tells the\nOCI runtime to pass the group access into the container. Currently only\navailable with the ",(0,i.kt)("inlineCode",{parentName:"p"},"crun")," OCI runtime. Note: ",(0,i.kt)("inlineCode",{parentName:"p"},"keep-groups")," is exclusive, other\ngroups cannot be specified with this flag."),(0,i.kt)("h4",{id:"--help--h"},(0,i.kt)("strong",{parentName:"h4"},"--help"),", ",(0,i.kt)("strong",{parentName:"h4"},"-h")),(0,i.kt)("p",null,"Print usage statement"),(0,i.kt)("h4",{id:"--hooks-dirpath"},(0,i.kt)("strong",{parentName:"h4"},"--hooks-dir"),"=",(0,i.kt)("em",{parentName:"h4"},"path")),(0,i.kt)("p",null,"Each ","*",".json file in the path configures a hook for buildah build containers. For more details on the syntax of the JSON files and the semantics of hook injection. Buildah currently support both the 1.0.0 and 0.0 hook schemas, although the 0.0 schema is deprecated."),(0,i.kt)("p",null,"This option may be set multiple times; paths from later options have higher precedence."),(0,i.kt)("p",null,"For the annotation conditions, buildah uses any annotations set in the generated OCI configuration."),(0,i.kt)("p",null,"For the bind-mount conditions, only mounts explicitly requested by the caller via --volume are considered. Bind mounts that buildah inserts by default (e.g. /dev/shm) are not considered."),(0,i.kt)("p",null,"If --hooks-dir is unset for root callers, Buildah will currently default to /usr/share/containers/oci/hooks.d and /etc/containers/oci/hooks.d in order of increasing precedence. Using these defaults is deprecated, and callers should migrate to explicitly setting --hooks-dir."),(0,i.kt)("p",null,"@@option http-proxy"),(0,i.kt)("h4",{id:"--identity-label"},(0,i.kt)("strong",{parentName:"h4"},"--identity-label")),(0,i.kt)("p",null,"Adds default identity label ",(0,i.kt)("inlineCode",{parentName:"p"},"io.buildah.version")," if set. (default true)."),(0,i.kt)("h4",{id:"--ignorefile"},(0,i.kt)("strong",{parentName:"h4"},"--ignorefile")),(0,i.kt)("p",null,"Path to an alternative .containerignore file."),(0,i.kt)("h4",{id:"--iidfileimageidfile"},(0,i.kt)("strong",{parentName:"h4"},"--iidfile"),"=",(0,i.kt)("em",{parentName:"h4"},"ImageIDfile")),(0,i.kt)("p",null,"Write the built image's ID to the file. When ",(0,i.kt)("inlineCode",{parentName:"p"},"--platform")," is specified more\nthan once, attempting to use this option will trigger an error."),(0,i.kt)("h4",{id:"--ipchow"},(0,i.kt)("strong",{parentName:"h4"},"--ipc"),"=",(0,i.kt)("em",{parentName:"h4"},"how")),(0,i.kt)("p",null,"Sets the configuration for IPC namespaces when handling ",(0,i.kt)("inlineCode",{parentName:"p"},"RUN"),' instructions.\nThe configured value can be "" (the empty string) or "container" to indicate\nthat a new IPC namespace should be created, or it can be "host" to indicate\nthat the IPC namespace in which ',(0,i.kt)("inlineCode",{parentName:"p"},"podman")," itself is being run should be reused,\nor it can be the path to an IPC namespace which is already in use by\nanother process."),(0,i.kt)("h4",{id:"--isolationtype"},(0,i.kt)("strong",{parentName:"h4"},"--isolation"),"=",(0,i.kt)("em",{parentName:"h4"},"type")),(0,i.kt)("p",null,"Controls what type of isolation is used for running processes as part of ",(0,i.kt)("inlineCode",{parentName:"p"},"RUN"),"\ninstructions. Recognized types include ",(0,i.kt)("em",{parentName:"p"},"oci")," (OCI-compatible runtime, the\ndefault), ",(0,i.kt)("em",{parentName:"p"},"rootless")," (OCI-compatible runtime invoked using a modified\nconfiguration and its --rootless option enabled, with ",(0,i.kt)("em",{parentName:"p"},"--no-new-keyring\n--no-pivot")," added to its ",(0,i.kt)("em",{parentName:"p"},"create")," invocation, with network and UTS namespaces\ndisabled, and IPC, PID, and user namespaces enabled; the default for\nunprivileged users), and ",(0,i.kt)("em",{parentName:"p"},"chroot")," (an internal wrapper that leans more toward\nchroot(1) than container technology)."),(0,i.kt)("p",null,"Note: You can also override the default isolation type by setting the\nBUILDAH_ISOLATION environment variable. ",(0,i.kt)("inlineCode",{parentName:"p"},"export BUILDAH_ISOLATION=oci")),(0,i.kt)("h4",{id:"--jobsnumber"},(0,i.kt)("strong",{parentName:"h4"},"--jobs"),"=",(0,i.kt)("em",{parentName:"h4"},"number")),(0,i.kt)("p",null,"Run up to N concurrent stages in parallel. If the number of jobs is greater\nthan 1, stdin will be read from /dev/null. If 0 is specified, then there is\nno limit in the number of jobs that run in parallel."),(0,i.kt)("h4",{id:"--labellabel"},(0,i.kt)("strong",{parentName:"h4"},"--label"),"=",(0,i.kt)("em",{parentName:"h4"},"label")),(0,i.kt)("p",null,"Add an image ",(0,i.kt)("em",{parentName:"p"},"label")," (e.g. label=",(0,i.kt)("em",{parentName:"p"},"value"),") to the image metadata. Can be used\nmultiple times."),(0,i.kt)("p",null,"Users can set a special LABEL ",(0,i.kt)("strong",{parentName:"p"},"io.containers.capabilities=CAP1,CAP2,CAP3")," in\na Containerfile that specifies the list of Linux capabilities required for the\ncontainer to run properly. This label specified in a container image tells\nPodman to run the container with just these capabilities. Podman launches the\ncontainer with just the specified capabilities, as long as this list of\ncapabilities is a subset of the default list."),(0,i.kt)("p",null,"If the specified capabilities are not in the default set, Podman will\nprint an error message and will run the container with the default capabilities."),(0,i.kt)("h4",{id:"--layers"},(0,i.kt)("strong",{parentName:"h4"},"--layers")),(0,i.kt)("p",null,"Cache intermediate images during the build process (Default is ",(0,i.kt)("inlineCode",{parentName:"p"},"true"),")."),(0,i.kt)("p",null,"Note: You can also override the default value of layers by setting the\nBUILDAH_LAYERS environment variable. ",(0,i.kt)("inlineCode",{parentName:"p"},"export BUILDAH_LAYERS=true")),(0,i.kt)("h4",{id:"--logfilefilename"},(0,i.kt)("strong",{parentName:"h4"},"--logfile"),"=",(0,i.kt)("em",{parentName:"h4"},"filename")),(0,i.kt)("p",null,"Log output which would be sent to standard output and standard error to the\nspecified file instead of to standard output and standard error.\nThis option is not supported on the remote client, including Mac and Windows\n(excluding WSL2) machines."),(0,i.kt)("h4",{id:"--logsplitbool-value"},(0,i.kt)("strong",{parentName:"h4"},"--logsplit"),"=",(0,i.kt)("em",{parentName:"h4"},"bool-value")),(0,i.kt)("p",null,"If ",(0,i.kt)("inlineCode",{parentName:"p"},"--logfile")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"--platform")," are specified, the ",(0,i.kt)("inlineCode",{parentName:"p"},"--logsplit")," option allows\nend-users to split the log file for each platform into different files in the\nfollowing format: ",(0,i.kt)("inlineCode",{parentName:"p"},"${logfile}_${platform-os}_${platform-arch}"),".\nThis option is not supported on the remote client, including Mac and Windows\n(excluding WSL2) machines."),(0,i.kt)("h4",{id:"--manifestmanifest"},(0,i.kt)("strong",{parentName:"h4"},"--manifest"),"=",(0,i.kt)("em",{parentName:"h4"},"manifest")),(0,i.kt)("p",null,"Name of the manifest list to which the image will be added. Creates the manifest list\nif it does not exist. This option is useful for building multi architecture images."),(0,i.kt)("p",null,"@@option memory"),(0,i.kt)("p",null,"@@option memory-swap"),(0,i.kt)("h4",{id:"--networkmode---net"},(0,i.kt)("strong",{parentName:"h4"},"--network"),"=",(0,i.kt)("em",{parentName:"h4"},"mode"),", ",(0,i.kt)("strong",{parentName:"h4"},"--net")),(0,i.kt)("p",null,"Sets the configuration for network namespaces when handling ",(0,i.kt)("inlineCode",{parentName:"p"},"RUN")," instructions."),(0,i.kt)("p",null,"Valid ",(0,i.kt)("em",{parentName:"p"},"mode")," values are:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"none"),": no networking."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"host"),": use the Podman host network stack. Note: the host mode gives the\ncontainer full access to local system services such as D-bus and is therefore\nconsidered insecure."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"ns:"),(0,i.kt)("em",{parentName:"li"},"path"),": path to a network namespace to join."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"private"),": create a new namespace for the container (default)"),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"\\<network name|ID",">"),": Join the network with the given name or ID, e.g. use ",(0,i.kt)("inlineCode",{parentName:"li"},"--network mynet")," to join the network with the name mynet. Only supported for rootful users.")),(0,i.kt)("h4",{id:"--no-cache"},(0,i.kt)("strong",{parentName:"h4"},"--no-cache")),(0,i.kt)("p",null,"Do not use existing cached images for the container build. Build from the start\nwith a new set of cached layers."),(0,i.kt)("p",null,"@@option no-hosts"),(0,i.kt)("p",null,"This option conflicts with ",(0,i.kt)("strong",{parentName:"p"},"--add-host"),"."),(0,i.kt)("h4",{id:"--omit-history"},(0,i.kt)("strong",{parentName:"h4"},"--omit-history")),(0,i.kt)("p",null,"Omit build history information in the built image. (default false)."),(0,i.kt)("p",null,"This option is useful for the cases where end users explicitly\nwant to set ",(0,i.kt)("inlineCode",{parentName:"p"},"--omit-history")," to omit the optional ",(0,i.kt)("inlineCode",{parentName:"p"},"History")," from\nbuilt images or when working with images built using build tools that\ndo not include ",(0,i.kt)("inlineCode",{parentName:"p"},"History")," information in their images."),(0,i.kt)("h4",{id:"--osstring"},(0,i.kt)("strong",{parentName:"h4"},"--os"),"=",(0,i.kt)("em",{parentName:"h4"},"string")),(0,i.kt)("p",null,"Set the OS of the image to be built, and that of the base image to be pulled,\nif the build uses one, instead of using the current operating system of the\nbuild host. Unless overridden, subsequent lookups of the same image in the\nlocal storage will match this OS, regardless of the host."),(0,i.kt)("h4",{id:"--os-featurefeature"},(0,i.kt)("strong",{parentName:"h4"},"--os-feature"),"=",(0,i.kt)("em",{parentName:"h4"},"feature")),(0,i.kt)("p",null,"Set the name of a required operating system ",(0,i.kt)("em",{parentName:"p"},"feature")," for the image which will\nbe built. By default, if the image is not based on ",(0,i.kt)("em",{parentName:"p"},"scratch"),", the base image's\nrequired OS feature list is kept, if the base image specified any. This option\nis typically only meaningful when the image's OS is Windows."),(0,i.kt)("p",null,"If ",(0,i.kt)("em",{parentName:"p"},"feature")," has a trailing ",(0,i.kt)("inlineCode",{parentName:"p"},"-"),", then the ",(0,i.kt)("em",{parentName:"p"},"feature")," is removed from the set of\nrequired features which will be listed in the image."),(0,i.kt)("h4",{id:"--os-versionversion"},(0,i.kt)("strong",{parentName:"h4"},"--os-version"),"=",(0,i.kt)("em",{parentName:"h4"},"version")),(0,i.kt)("p",null,"Set the exact required operating system ",(0,i.kt)("em",{parentName:"p"},"version")," for the image which will be\nbuilt. By default, if the image is not based on ",(0,i.kt)("em",{parentName:"p"},"scratch"),", the base image's\nrequired OS version is kept, if the base image specified one. This option is\ntypically only meaningful when the image's OS is Windows, and is typically set in\nWindows base images, so using this option is usually unnecessary."),(0,i.kt)("h4",{id:"--output--ooutput-opts"},(0,i.kt)("strong",{parentName:"h4"},"--output"),", ",(0,i.kt)("strong",{parentName:"h4"},"-o"),"=",(0,i.kt)("em",{parentName:"h4"},"output-opts")),(0,i.kt)("p",null,"Output destination (format: type=local,dest=path)"),(0,i.kt)("p",null,"The --output (or -o) option extends the default behavior of building a container image by allowing users to export the contents of the image as files on the local filesystem, which can be useful for generating local binaries, code generation, etc. (This option is not available with the remote Podman client, including Mac and Windows (excluding WSL2) machines)"),(0,i.kt)("p",null,"The value for --output is a comma-separated sequence of key=value pairs, defining the output type and options."),(0,i.kt)("p",null,"Supported ",(0,i.kt)("em",{parentName:"p"},"keys")," are:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"dest"),": Destination path for exported output. Valid value is absolute or relative path, ",(0,i.kt)("inlineCode",{parentName:"li"},"-")," means the standard output."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"type"),": Defines the type of output to be used. Valid values is documented below.")),(0,i.kt)("p",null,"Valid ",(0,i.kt)("em",{parentName:"p"},"type")," values are:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"local"),": write the resulting build files to a directory on the client-side."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"tar"),": write the resulting files as a single tarball (.tar).")),(0,i.kt)("p",null,"If no type is specified, the value defaults to ",(0,i.kt)("strong",{parentName:"p"},"local"),".\nAlternatively, instead of a comma-separated sequence, the value of ",(0,i.kt)("strong",{parentName:"p"},"--output")," can be just a destination (in the ",(0,i.kt)("inlineCode",{parentName:"p"},"**dest** format) (e.g. "),"--output some-path",(0,i.kt)("inlineCode",{parentName:"p"},", "),"--output -",(0,i.kt)("inlineCode",{parentName:"p"},") where "),"--output some-path",(0,i.kt)("inlineCode",{parentName:"p"},"is treated as if **type=local** and"),"--output -` is treated as if ",(0,i.kt)("strong",{parentName:"p"},"type=tar"),"."),(0,i.kt)("h4",{id:"--pidpid"},(0,i.kt)("strong",{parentName:"h4"},"--pid"),"=",(0,i.kt)("em",{parentName:"h4"},"pid")),(0,i.kt)("p",null,"Sets the configuration for PID namespaces when handling ",(0,i.kt)("inlineCode",{parentName:"p"},"RUN"),' instructions.\nThe configured value can be "" (the empty string) or "container" to indicate\nthat a new PID namespace should be created, or it can be "host" to indicate\nthat the PID namespace in which ',(0,i.kt)("inlineCode",{parentName:"p"},"podman")," itself is being run should be reused,\nor it can be the path to a PID namespace which is already in use by another\nprocess."),(0,i.kt)("h4",{id:"--platformosarchvariant"},(0,i.kt)("strong",{parentName:"h4"},"--platform"),"=",(0,i.kt)("em",{parentName:"h4"},"os/arch","[/variant][,...]")),(0,i.kt)("p",null,"Set the ",(0,i.kt)("em",{parentName:"p"},"os/arch")," of the built image (and its base image, when using one)\nto the provided value instead of using the current operating system and\narchitecture of the host (for example ",(0,i.kt)("inlineCode",{parentName:"p"},"linux/arm"),"). Unless overridden,\nsubsequent lookups of the same image in the local storage will match this\nplatform, regardless of the host."),(0,i.kt)("p",null,"If ",(0,i.kt)("inlineCode",{parentName:"p"},"--platform")," is set, then the values of the ",(0,i.kt)("inlineCode",{parentName:"p"},"--arch"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"--os"),", and\n",(0,i.kt)("inlineCode",{parentName:"p"},"--variant")," options will be overridden."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"--platform")," option can be specified more than once, or given a\ncomma-separated list of values as its argument. When more than one platform is\nspecified, the ",(0,i.kt)("inlineCode",{parentName:"p"},"--manifest")," option should be used instead of the ",(0,i.kt)("inlineCode",{parentName:"p"},"--tag"),"\noption."),(0,i.kt)("p",null,"Os/arch pairs are those used by the Go Programming Language. In several cases\nthe ",(0,i.kt)("em",{parentName:"p"},"arch")," value for a platform differs from one produced by other tools such as\nthe ",(0,i.kt)("inlineCode",{parentName:"p"},"arch")," command. Valid OS and architecture name combinations are listed as\nvalues for $GOOS and $GOARCH at ",(0,i.kt)("a",{parentName:"p",href:"https://golang.org/doc/install/source#environment"},"https://golang.org/doc/install/source#environment"),",\nand can also be found by running ",(0,i.kt)("inlineCode",{parentName:"p"},"go tool dist list"),"."),(0,i.kt)("p",null,"While ",(0,i.kt)("inlineCode",{parentName:"p"},"podman build")," is happy to use base images and build images for any\nplatform that exists, ",(0,i.kt)("inlineCode",{parentName:"p"},"RUN")," instructions will not be able to succeed without\nthe help of emulation provided by packages like ",(0,i.kt)("inlineCode",{parentName:"p"},"qemu-user-static"),"."),(0,i.kt)("h4",{id:"--pullpolicy"},(0,i.kt)("strong",{parentName:"h4"},"--pull"),"=",(0,i.kt)("em",{parentName:"h4"},"policy")),(0,i.kt)("p",null,"Pull image policy. The default is ",(0,i.kt)("strong",{parentName:"p"},"always"),"."),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"always"),", ",(0,i.kt)("strong",{parentName:"li"},"true"),": Always pull the image and throw an error if the pull fails."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"missing"),": Pull the image only if it could not be found in the local containers storage. Throw an error if no image could be found and the pull fails."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"never"),", ",(0,i.kt)("strong",{parentName:"li"},"false"),": Never pull the image but use the one from the local containers storage. Throw an error if no image could be found."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("strong",{parentName:"li"},"newer"),": Pull if the image on the registry is newer than the one in the local containers storage. An image is considered to be newer when the digests are different. Comparing the time stamps is prone to errors. Pull errors are suppressed if a local image was found.")),(0,i.kt)("h4",{id:"--quiet--q"},(0,i.kt)("strong",{parentName:"h4"},"--quiet"),", ",(0,i.kt)("strong",{parentName:"h4"},"-q")),(0,i.kt)("p",null,"Suppress output messages which indicate which instruction is being processed,\nand of progress when pulling images from a registry, and when writing the\noutput image."),(0,i.kt)("h4",{id:"--retryattempts"},(0,i.kt)("strong",{parentName:"h4"},"--retry"),"=",(0,i.kt)("em",{parentName:"h4"},"attempts")),(0,i.kt)("p",null,"Number of times to retry in case of failure when performing pull of\nimages from registry. Default is ",(0,i.kt)("strong",{parentName:"p"},"3"),"."),(0,i.kt)("h4",{id:"--retry-delayduration"},(0,i.kt)("strong",{parentName:"h4"},"--retry-delay"),"=",(0,i.kt)("em",{parentName:"h4"},"duration")),(0,i.kt)("p",null,"Duration of delay between retry attempts in case of failure when performing\npull of images from registry. Default is ",(0,i.kt)("strong",{parentName:"p"},"2s"),"."),(0,i.kt)("h4",{id:"--rm"},(0,i.kt)("strong",{parentName:"h4"},"--rm")),(0,i.kt)("p",null,"Remove intermediate containers after a successful build (default true)."),(0,i.kt)("h4",{id:"--runtimepath"},(0,i.kt)("strong",{parentName:"h4"},"--runtime"),"=",(0,i.kt)("em",{parentName:"h4"},"path")),(0,i.kt)("p",null,"The ",(0,i.kt)("em",{parentName:"p"},"path")," to an alternate OCI-compatible runtime, which will be used to run\ncommands specified by the ",(0,i.kt)("strong",{parentName:"p"},"RUN")," instruction."),(0,i.kt)("p",null,"Note: You can also override the default runtime by setting the BUILDAH_RUNTIME\nenvironment variable. ",(0,i.kt)("inlineCode",{parentName:"p"},"export BUILDAH_RUNTIME=/usr/local/bin/runc")),(0,i.kt)("h4",{id:"--runtime-flagflag"},(0,i.kt)("strong",{parentName:"h4"},"--runtime-flag"),"=",(0,i.kt)("em",{parentName:"h4"},"flag")),(0,i.kt)("p",null,"Adds global flags for the container rutime. To list the supported flags, please consult the manpages of the selected container runtime."),(0,i.kt)("p",null,"Note: Do not pass the leading -- to the flag. To pass the runc flag --log-format json to buildah build, the option given would be --runtime-flag log-format=json."),(0,i.kt)("h4",{id:"--secretididsrcpath"},(0,i.kt)("strong",{parentName:"h4"},"--secret"),"=",(0,i.kt)("strong",{parentName:"h4"},"id=id,src=path")),(0,i.kt)("p",null,"Pass secret information to be used in the Containerfile for building images\nin a safe way that will not end up stored in the final image, or be seen in other stages.\nThe secret will be mounted in the container at the default location of ",(0,i.kt)("inlineCode",{parentName:"p"},"/run/secrets/id"),"."),(0,i.kt)("p",null,"To later use the secret, use the --mount option in a ",(0,i.kt)("inlineCode",{parentName:"p"},"RUN")," instruction within a ",(0,i.kt)("inlineCode",{parentName:"p"},"Containerfile"),":"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"RUN --mount=type=secret,id=mysecret cat /run/secrets/mysecret")),(0,i.kt)("h4",{id:"--security-optoption"},(0,i.kt)("strong",{parentName:"h4"},"--security-opt"),"=",(0,i.kt)("em",{parentName:"h4"},"option")),(0,i.kt)("p",null,"Security Options"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"apparmor=unconfined")," : Turn off apparmor confinement for the container")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"apparmor=alternate-profile")," : Set the apparmor confinement profile for the\ncontainer")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"label=user:USER")," : Set the label user for the container processes")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"label=role:ROLE")," : Set the label role for the container processes")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"label=type:TYPE")," : Set the label process type for the container processes")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"label=level:LEVEL")," : Set the label level for the container processes")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"label=filetype:TYPE")," : Set the label file type for the container files")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"label=disable")," : Turn off label separation for the container")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"no-new-privileges")," : Not supported")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"seccomp=unconfined")," : Turn off seccomp confinement for the container")),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("p",{parentName:"li"},(0,i.kt)("inlineCode",{parentName:"p"},"seccomp=profile.json")," : White listed syscalls seccomp Json file to be used\nas a seccomp filter"))),(0,i.kt)("p",null,"@@option shm-size"),(0,i.kt)("h4",{id:"--sign-byfingerprint"},(0,i.kt)("strong",{parentName:"h4"},"--sign-by"),"=",(0,i.kt)("em",{parentName:"h4"},"fingerprint")),(0,i.kt)("p",null,"Sign the image using a GPG key with the specified FINGERPRINT. (This option is not available with the remote Podman client, including Mac and Windows (excluding WSL2) machines,)"),(0,i.kt)("h4",{id:"--skip-unused-stages"},(0,i.kt)("strong",{parentName:"h4"},"--skip-unused-stages")),(0,i.kt)("p",null,"Skip stages in multi-stage builds which don't affect the target stage. (Default: ",(0,i.kt)("strong",{parentName:"p"},"true"),")."),(0,i.kt)("h4",{id:"--squash"},(0,i.kt)("strong",{parentName:"h4"},"--squash")),(0,i.kt)("p",null,"Squash all of the image's new layers into a single new layer; any preexisting\nlayers are not squashed."),(0,i.kt)("h4",{id:"--squash-all"},(0,i.kt)("strong",{parentName:"h4"},"--squash-all")),(0,i.kt)("p",null,"Squash all of the new image's layers (including those inherited from a base\nimage) into a single new layer."),(0,i.kt)("h4",{id:"--sshdefault--idsocket"},(0,i.kt)("strong",{parentName:"h4"},"--ssh"),"=",(0,i.kt)("em",{parentName:"h4"},"default")," | ",(0,i.kt)("em",{parentName:"h4"},"id[=socket>")),(0,i.kt)("p",null,"SSH agent socket or keys to expose to the build.\nThe socket path can be left empty to use the value of ",(0,i.kt)("inlineCode",{parentName:"p"},"default=$SSH_AUTH_SOCK")),(0,i.kt)("p",null,"To later use the ssh agent, use the --mount option in a ",(0,i.kt)("inlineCode",{parentName:"p"},"RUN")," instruction within a ",(0,i.kt)("inlineCode",{parentName:"p"},"Containerfile"),":"),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"RUN --mount=type=ssh,id=id mycmd")),(0,i.kt)("h4",{id:"--stdin"},(0,i.kt)("strong",{parentName:"h4"},"--stdin")),(0,i.kt)("p",null,"Pass stdin into the RUN containers. Sometime commands being RUN within a Containerfile\nwant to request information from the user. For example apt asking for a confirmation for install.\nUse --stdin to be able to interact from the terminal during the build."),(0,i.kt)("h4",{id:"--tag--timagename"},(0,i.kt)("strong",{parentName:"h4"},"--tag"),", ",(0,i.kt)("strong",{parentName:"h4"},"-t"),"=",(0,i.kt)("em",{parentName:"h4"},"imageName")),(0,i.kt)("p",null,"Specifies the name which will be assigned to the resulting image if the build\nprocess completes successfully.\nIf ",(0,i.kt)("em",{parentName:"p"},"imageName")," does not include a registry name, the registry name ",(0,i.kt)("em",{parentName:"p"},"localhost"),"\nwill be prepended to the image name."),(0,i.kt)("h4",{id:"--targetstagename"},(0,i.kt)("strong",{parentName:"h4"},"--target"),"=",(0,i.kt)("em",{parentName:"h4"},"stageName")),(0,i.kt)("p",null,"Set the target build stage to build. When building a Containerfile with\nmultiple build stages, --target can be used to specify an intermediate build\nstage by name as the final stage for the resulting image. Commands after the target stage will be skipped."),(0,i.kt)("h4",{id:"--timestampseconds"},(0,i.kt)("strong",{parentName:"h4"},"--timestamp"),"=",(0,i.kt)("em",{parentName:"h4"},"seconds")),(0,i.kt)("p",null,"Set the create timestamp to seconds since epoch to allow for deterministic\nbuilds (defaults to current time). By default, the created timestamp is changed\nand written into the image manifest with every commit, causing the image's\nsha256 hash to be different even if the sources are exactly the same otherwise.\nWhen --timestamp is set, the created timestamp is always set to the time\nspecified and therefore not changed, allowing the image's sha256 hash to remain the\nsame. All files committed to the layers of the image will be created with the\ntimestamp."),(0,i.kt)("p",null,"If the only instruction in a Containerfile is ",(0,i.kt)("inlineCode",{parentName:"p"},"FROM"),", this flag has no effect."),(0,i.kt)("p",null,"@@option tls-verify"),(0,i.kt)("h4",{id:"--ulimittypesoft-limithard-limit"},(0,i.kt)("strong",{parentName:"h4"},"--ulimit"),"=",(0,i.kt)("em",{parentName:"h4"},"type=soft-limit","[:hard-limit]")),(0,i.kt)("p",null,"Specifies resource limits to apply to processes launched when processing ",(0,i.kt)("inlineCode",{parentName:"p"},"RUN"),'\ninstructions. This option can be specified multiple times. Recognized resource\ntypes include:\n"core": maximum core dump size (ulimit -c)\n"cpu": maximum CPU time (ulimit -t)\n"data": maximum size of a process\'s data segment (ulimit -d)\n"fsize": maximum size of new files (ulimit -f)\n"locks": maximum number of file locks (ulimit -x)\n"memlock": maximum amount of locked memory (ulimit -l)\n"msgqueue": maximum amount of data in message queues (ulimit -q)\n"nice": niceness adjustment (nice -n, ulimit -e)\n"nofile": maximum number of open files (ulimit -n)\n"nproc": maximum number of processes (ulimit -u)\n"rss": maximum size of a process\'s (ulimit -m)\n"rtprio": maximum real-time scheduling priority (ulimit -r)\n"rttime": maximum amount of real-time execution between blocking syscalls\n"sigpending": maximum number of pending signals (ulimit -i)\n"stack": maximum stack size (ulimit -s)'),(0,i.kt)("h4",{id:"--unsetenvenv"},(0,i.kt)("strong",{parentName:"h4"},"--unsetenv"),"=",(0,i.kt)("em",{parentName:"h4"},"env")),(0,i.kt)("p",null,"Unset environment variables from the final image."),(0,i.kt)("h4",{id:"--usernshow"},(0,i.kt)("strong",{parentName:"h4"},"--userns"),"=",(0,i.kt)("em",{parentName:"h4"},"how")),(0,i.kt)("p",null,"Sets the configuration for user namespaces when handling ",(0,i.kt)("inlineCode",{parentName:"p"},"RUN"),' instructions.\nThe configured value can be "" (the empty string) or "container" to indicate\nthat a new user namespace should be created, it can be "host" to indicate that\nthe user namespace in which ',(0,i.kt)("inlineCode",{parentName:"p"},"podman")," itself is being run should be reused, or\nit can be the path to a user namespace which is already in use by another\nprocess."),(0,i.kt)("h4",{id:"--userns-gid-mapmapping"},(0,i.kt)("strong",{parentName:"h4"},"--userns-gid-map"),"=",(0,i.kt)("em",{parentName:"h4"},"mapping")),(0,i.kt)("p",null,"Directly specifies a GID mapping which should be used to set ownership, at the\nfilesystem level, on the working container's contents.\nCommands run when handling ",(0,i.kt)("inlineCode",{parentName:"p"},"RUN")," instructions will default to being run in\ntheir own user namespaces, configured using the UID and GID maps."),(0,i.kt)("p",null,"Entries in this map take the form of one or more triples of a starting\nin-container GID, a corresponding starting host-level GID, and the number of\nconsecutive IDs which the map entry represents."),(0,i.kt)("p",null,"This option overrides the ",(0,i.kt)("em",{parentName:"p"},"remap-gids")," setting in the ",(0,i.kt)("em",{parentName:"p"},"options")," section of\n/etc/containers/storage.conf."),(0,i.kt)("p",null,"If this option is not specified, but a global --userns-gid-map setting is\nsupplied, settings from the global option will be used."),(0,i.kt)("p",null,"If none of --userns-uid-map-user, --userns-gid-map-group, or --userns-gid-map\nare specified, but --userns-uid-map is specified, the GID map will be set to\nuse the same numeric values as the UID map."),(0,i.kt)("h4",{id:"--userns-gid-map-groupgroup"},(0,i.kt)("strong",{parentName:"h4"},"--userns-gid-map-group"),"=",(0,i.kt)("em",{parentName:"h4"},"group")),(0,i.kt)("p",null,"Specifies that a GID mapping which should be used to set ownership, at the\nfilesystem level, on the working container's contents, can be found in entries\nin the ",(0,i.kt)("inlineCode",{parentName:"p"},"/etc/subgid")," file which correspond to the specified group.\nCommands run when handling ",(0,i.kt)("inlineCode",{parentName:"p"},"RUN")," instructions will default to being run in\ntheir own user namespaces, configured using the UID and GID maps.\nIf --userns-uid-map-user is specified, but --userns-gid-map-group is not\nspecified, ",(0,i.kt)("inlineCode",{parentName:"p"},"podman")," will assume that the specified user name is also a\nsuitable group name to use as the default setting for this option."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"NOTE:")," When this option is specified by a rootless user, the specified\nmappings are relative to the rootless user namespace in the container, rather\nthan being relative to the host as it would be when run rootful."),(0,i.kt)("h4",{id:"--userns-uid-mapmapping"},(0,i.kt)("strong",{parentName:"h4"},"--userns-uid-map"),"=",(0,i.kt)("em",{parentName:"h4"},"mapping")),(0,i.kt)("p",null,"Directly specifies a UID mapping which should be used to set ownership, at the\nfilesystem level, on the working container's contents.\nCommands run when handling ",(0,i.kt)("inlineCode",{parentName:"p"},"RUN")," instructions will default to being run in\ntheir own user namespaces, configured using the UID and GID maps."),(0,i.kt)("p",null,"Entries in this map take the form of one or more triples of a starting\nin-container UID, a corresponding starting host-level UID, and the number of\nconsecutive IDs which the map entry represents."),(0,i.kt)("p",null,"This option overrides the ",(0,i.kt)("em",{parentName:"p"},"remap-uids")," setting in the ",(0,i.kt)("em",{parentName:"p"},"options")," section of\n/etc/containers/storage.conf."),(0,i.kt)("p",null,"If this option is not specified, but a global --userns-uid-map setting is\nsupplied, settings from the global option will be used."),(0,i.kt)("p",null,"If none of --userns-uid-map-user, --userns-gid-map-group, or --userns-uid-map\nare specified, but --userns-gid-map is specified, the UID map will be set to\nuse the same numeric values as the GID map."),(0,i.kt)("h4",{id:"--userns-uid-map-useruser"},(0,i.kt)("strong",{parentName:"h4"},"--userns-uid-map-user"),"=",(0,i.kt)("em",{parentName:"h4"},"user")),(0,i.kt)("p",null,"Specifies that a UID mapping which should be used to set ownership, at the\nfilesystem level, on the working container's contents, can be found in entries\nin the ",(0,i.kt)("inlineCode",{parentName:"p"},"/etc/subuid")," file which correspond to the specified user.\nCommands run when handling ",(0,i.kt)("inlineCode",{parentName:"p"},"RUN")," instructions will default to being run in\ntheir own user namespaces, configured using the UID and GID maps.\nIf --userns-gid-map-group is specified, but --userns-uid-map-user is not\nspecified, ",(0,i.kt)("inlineCode",{parentName:"p"},"podman")," will assume that the specified group name is also a\nsuitable user name to use as the default setting for this option."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"NOTE:")," When this option is specified by a rootless user, the specified\nmappings are relative to the rootless user namespace in the container, rather\nthan being relative to the host as it would be when run rootful."),(0,i.kt)("h4",{id:"--utshow"},(0,i.kt)("strong",{parentName:"h4"},"--uts"),"=",(0,i.kt)("em",{parentName:"h4"},"how")),(0,i.kt)("p",null,"Sets the configuration for UTS namespaces when handling ",(0,i.kt)("inlineCode",{parentName:"p"},"RUN"),' instructions.\nThe configured value can be "" (the empty string) or "container" to indicate\nthat a new UTS namespace should be created, or it can be "host" to indicate\nthat the UTS namespace in which ',(0,i.kt)("inlineCode",{parentName:"p"},"podman")," itself is being run should be reused,\nor it can be the path to a UTS namespace which is already in use by another\nprocess."),(0,i.kt)("h4",{id:"--variantvariant"},(0,i.kt)("strong",{parentName:"h4"},"--variant"),"=",(0,i.kt)("em",{parentName:"h4"},"variant")),(0,i.kt)("p",null,"Set the architecture variant of the image to be built, and that of the base\nimage to be pulled, if the build uses one, to the provided value instead of\nusing the architecture variant of the build host."),(0,i.kt)("h4",{id:"--volume--vhost-dircontainer-diroptions"},(0,i.kt)("strong",{parentName:"h4"},"--volume"),", ",(0,i.kt)("strong",{parentName:"h4"},"-v"),"=",(0,i.kt)("em",{parentName:"h4"},"[HOST-DIR:CONTAINER-DIR","[:OPTIONS]","]")),(0,i.kt)("p",null,"Create a bind mount. Specifying the ",(0,i.kt)("inlineCode",{parentName:"p"},"-v /HOST-DIR:/CONTAINER-DIR")," option, Podman\nbind mounts ",(0,i.kt)("inlineCode",{parentName:"p"},"/HOST-DIR")," from the host to ",(0,i.kt)("inlineCode",{parentName:"p"},"/CONTAINER-DIR")," in the Podman\ncontainer."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"OPTIONS")," are a comma-separated list and can be: ",(0,i.kt)("sup",null,(0,i.kt)("a",{parentName:"p",href:"#Footnote1"},"[1]"))),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"[rw|ro]"),(0,i.kt)("li",{parentName:"ul"},"[z|Z|O]"),(0,i.kt)("li",{parentName:"ul"},"[U]"),(0,i.kt)("li",{parentName:"ul"},"[",(0,i.kt)("inlineCode",{parentName:"li"},"[r]shared"),"|",(0,i.kt)("inlineCode",{parentName:"li"},"[r]slave"),"|",(0,i.kt)("inlineCode",{parentName:"li"},"[r]private"),"]")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"CONTAINER-DIR")," must be an absolute path such as ",(0,i.kt)("inlineCode",{parentName:"p"},"/src/docs"),". The ",(0,i.kt)("inlineCode",{parentName:"p"},"HOST-DIR"),"\nmust be an absolute path as well. Podman bind-mounts the ",(0,i.kt)("inlineCode",{parentName:"p"},"HOST-DIR")," to the\nspecified path. For example, when specifying the host path ",(0,i.kt)("inlineCode",{parentName:"p"},"/foo"),",\nPodman copies the contents of ",(0,i.kt)("inlineCode",{parentName:"p"},"/foo")," to the container filesystem on the host\nand bind mounts that into the container."),(0,i.kt)("p",null,"You can specify multiple ",(0,i.kt)("strong",{parentName:"p"},"-v")," options to mount one or more mounts to a\ncontainer."),(0,i.kt)("p",null,"You can add the ",(0,i.kt)("inlineCode",{parentName:"p"},":ro")," or ",(0,i.kt)("inlineCode",{parentName:"p"},":rw")," suffix to a volume to mount it read-only or\nread-write mode, respectively. By default, the volumes are mounted read-write.\nSee examples."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"Chowning Volume Mounts")),(0,i.kt)("p",null,"By default, Podman does not change the owner and group of source volume\ndirectories mounted. When running using user namespaces, the UID and GID inside\nthe namespace may correspond to another UID and GID on the host."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},":U")," suffix tells Podman to use the correct host UID and GID based on the\nUID and GID within the namespace, to change recursively the owner and group of\nthe source volume."),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"Warning")," use with caution since this will modify the host filesystem."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"Labeling Volume Mounts")),(0,i.kt)("p",null,"Labeling systems like SELinux require that proper labels are placed on volume\ncontent mounted into a container. Without a label, the security system might\nprevent the processes running inside the container from using the content. By\ndefault, Podman does not change the labels set by the OS."),(0,i.kt)("p",null,"To change a label in the container context, add one of these two suffixes\n",(0,i.kt)("inlineCode",{parentName:"p"},":z")," or ",(0,i.kt)("inlineCode",{parentName:"p"},":Z")," to the volume mount. These suffixes tell Podman to relabel file\nobjects on the shared volumes. The ",(0,i.kt)("inlineCode",{parentName:"p"},"z")," option tells Podman that two containers\nshare the volume content. As a result, Podman labels the content with a shared\ncontent label. Shared volume labels allow all containers to read/write content.\nThe ",(0,i.kt)("inlineCode",{parentName:"p"},"Z")," option tells Podman to label the content with a private unshared label.\nOnly the current container can use a private volume."),(0,i.kt)("p",null,"Note: Do not relabel system files and directories. Relabeling system content\nmight cause other confined services on the host machine to fail. For these types\nof containers, disabling SELinux separation is recommended. The option\n",(0,i.kt)("inlineCode",{parentName:"p"},"--security-opt label=disable")," disables SELinux separation for the container.\nFor example, if a user wanted to volume mount their entire home directory into the build containers, they need to disable SELinux separation."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"   $ podman build --security-opt label=disable -v $HOME:/home/user .\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"Overlay Volume Mounts")),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},":O")," flag tells Podman to mount the directory from the host as a\ntemporary storage using the Overlay file system. The ",(0,i.kt)("inlineCode",{parentName:"p"},"RUN")," command containers\nare allowed to modify contents within the mountpoint and are stored in the\ncontainer storage in a separate directory. In Overlay FS terms the source\ndirectory will be the lower, and the container storage directory will be the\nupper. Modifications to the mount point are destroyed when the ",(0,i.kt)("inlineCode",{parentName:"p"},"RUN")," command\nfinishes executing, similar to a tmpfs mount point."),(0,i.kt)("p",null,"Any subsequent execution of ",(0,i.kt)("inlineCode",{parentName:"p"},"RUN")," commands sees the original source directory\ncontent, any changes from previous RUN commands no longer exists."),(0,i.kt)("p",null,"One use case of the ",(0,i.kt)("inlineCode",{parentName:"p"},"overlay")," mount is sharing the package cache from the\nhost into the container to allow speeding up builds."),(0,i.kt)("p",null,"Note:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"}," - Overlay mounts are not currently supported in rootless mode.\n - The `O` flag is not allowed to be specified with the `Z` or `z` flags.\n")),(0,i.kt)("p",null,"Content mounted into the container is labeled with the private label.\nOn SELinux systems, labels in the source directory needs to be readable\nby the container label. If not, SELinux container separation must be disabled\nfor the container to work. - Modification of the directory volume mounted into the container with an\noverlay mount can cause unexpected failures. Do not modify the directory until\nthe container finishes running."),(0,i.kt)("p",null,"By default bind mounted volumes are ",(0,i.kt)("inlineCode",{parentName:"p"},"private"),". That means any mounts done\ninside containers will not be visible on the host and vice versa. This behavior\ncan be changed by specifying a volume mount propagation property."),(0,i.kt)("p",null,"When the mount propagation policy is set to ",(0,i.kt)("inlineCode",{parentName:"p"},"shared"),", any mounts completed\ninside the container on that volume will be visible to both the host and\ncontainer. When the mount propagation policy is set to ",(0,i.kt)("inlineCode",{parentName:"p"},"slave"),", one way mount\npropagation is enabled and any mounts completed on the host for that volume will\nbe visible only inside of the container. To control the mount propagation\nproperty of volume use the ",(0,i.kt)("inlineCode",{parentName:"p"},":[r]shared"),", ",(0,i.kt)("inlineCode",{parentName:"p"},":[r]slave")," or ",(0,i.kt)("inlineCode",{parentName:"p"},":[r]private"),"\npropagation flag. For mount propagation to work on the source mount point (mount\npoint where source dir is mounted on) has to have the right propagation properties.\nFor shared volumes, the source mount point has to be shared. And for slave volumes,\nthe source mount has to be either shared or slave. ",(0,i.kt)("sup",null,(0,i.kt)("a",{parentName:"p",href:"#Footnote1"},"[1]"))),(0,i.kt)("p",null,"Use ",(0,i.kt)("inlineCode",{parentName:"p"},"df <source-dir>")," to determine the source mount and then use\n",(0,i.kt)("inlineCode",{parentName:"p"},"findmnt -o TARGET,PROPAGATION <source-mount-dir>")," to determine propagation\nproperties of source mount, if ",(0,i.kt)("inlineCode",{parentName:"p"},"findmnt")," utility is not available, the source\nmount point can be determined by looking at the mount entry in\n",(0,i.kt)("inlineCode",{parentName:"p"},"/proc/self/mountinfo"),". Look at ",(0,i.kt)("inlineCode",{parentName:"p"},"optional fields")," and see if any propagation\nproperties are specified.\n",(0,i.kt)("inlineCode",{parentName:"p"},"shared:X")," means the mount is ",(0,i.kt)("inlineCode",{parentName:"p"},"shared"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"master:X")," means the mount is ",(0,i.kt)("inlineCode",{parentName:"p"},"slave"),"\nand if nothing is there that means the mount is ",(0,i.kt)("inlineCode",{parentName:"p"},"private"),". ",(0,i.kt)("sup",null,(0,i.kt)("a",{parentName:"p",href:"#Footnote1"},"[1]"))),(0,i.kt)("p",null,"To change propagation properties of a mount point use the ",(0,i.kt)("inlineCode",{parentName:"p"},"mount")," command. For\nexample, to bind mount the source directory ",(0,i.kt)("inlineCode",{parentName:"p"},"/foo")," do\n",(0,i.kt)("inlineCode",{parentName:"p"},"mount --bind /foo /foo")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"mount --make-private --make-shared /foo"),". This\nwill convert /foo into a ",(0,i.kt)("inlineCode",{parentName:"p"},"shared")," mount point. The propagation properties of\nthe source mount can be changed directly. For instance if ",(0,i.kt)("inlineCode",{parentName:"p"},"/")," is the source\nmount for ",(0,i.kt)("inlineCode",{parentName:"p"},"/foo"),", then use ",(0,i.kt)("inlineCode",{parentName:"p"},"mount --make-shared /")," to convert ",(0,i.kt)("inlineCode",{parentName:"p"},"/")," into a\n",(0,i.kt)("inlineCode",{parentName:"p"},"shared")," mount."),(0,i.kt)("h2",{id:"examples"},"EXAMPLES"),(0,i.kt)("h3",{id:"build-an-image-using-local-containerfiles"},"Build an image using local Containerfiles"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ podman build .\n\n$ podman build -f Containerfile.simple .\n\n$ cat $HOME/Containerfile | podman build -f - .\n\n$ podman build -f Containerfile.simple -f Containerfile.notsosimple .\n\n$ podman build -f Containerfile.in $HOME\n\n$ podman build -t imageName .\n\n$ podman build --tls-verify=true -t imageName -f Containerfile.simple .\n\n$ podman build --tls-verify=false -t imageName .\n\n$ podman build --runtime-flag log-format=json .\n\n$ podman build --runtime-flag debug .\n\n$ podman build --authfile /tmp/auths/myauths.json --cert-dir $HOME/auth --tls-verify=true --creds=username:password -t imageName -f Containerfile.simple .\n\n$ podman build --memory 40m --cpu-period 10000 --cpu-quota 50000 --ulimit nofile=1024:1028 -t imageName .\n\n$ podman build --security-opt label=level:s0:c100,c200 --cgroup-parent /path/to/cgroup/parent -t imageName .\n\n$ podman build --volume /home/test:/myvol:ro,Z -t imageName .\n\n$ podman build -v /var/lib/yum:/var/lib/yum:O -t imageName .\n\n$ podman build --layers -t imageName .\n\n$ podman build --no-cache -t imageName .\n\n$ podman build --layers --force-rm -t imageName .\n\n$ podman build --no-cache --rm=false -t imageName .\n\n$ podman build --network mynet .\n")),(0,i.kt)("h3",{id:"building-a-multi-architecture-image-using-the---manifest-option-requires-emulation-software"},"Building a multi-architecture image using the --manifest option (requires emulation software)"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ podman build --arch arm --manifest myimage /tmp/mysrc\n\n$ podman build --arch amd64 --manifest myimage /tmp/mysrc\n\n$ podman build --arch s390x --manifest myimage /tmp/mysrc\n\n$ podman build --platform linux/s390x,linux/ppc64le,linux/amd64 --manifest myimage /tmp/mysrc\n\n$ podman build --platform linux/arm64 --platform linux/amd64 --manifest myimage /tmp/mysrc\n")),(0,i.kt)("h3",{id:"building-an-image-using-a-url-git-repo-or-archive"},"Building an image using a URL, Git repo, or archive"),(0,i.kt)("p",null,"The build context directory can be specified as a URL to a Containerfile, a\nGit repository, or URL to an archive. If the URL is a Containerfile, it is\ndownloaded to a temporary location and used as the context. When a Git\nrepository is set as the URL, the repository is cloned locally to a temporary\nlocation and then used as the context. Lastly, if the URL is an archive, it is\ndownloaded to a temporary location and extracted before being used as the\ncontext."),(0,i.kt)("h4",{id:"building-an-image-using-a-url-to-a-containerfile"},"Building an image using a URL to a Containerfile"),(0,i.kt)("p",null,"Podman will download the Containerfile to a temporary location and then use\nit as the build context."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ podman build https://1000/podman/Containerfile\n")),(0,i.kt)("h4",{id:"building-an-image-using-a-git-repository"},"Building an image using a Git repository"),(0,i.kt)("p",null,"Podman will clone the specified GitHub repository to a temporary location and\nuse it as the context. The Containerfile at the root of the repository will be\nused and it only works if the GitHub repository is a dedicated repository."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ podman build https://github.com/scollier/purpletest\n")),(0,i.kt)("p",null,"Note: Github does not support using ",(0,i.kt)("inlineCode",{parentName:"p"},"git://")," for performing ",(0,i.kt)("inlineCode",{parentName:"p"},"clone")," operation due to recent changes in their security guidance (",(0,i.kt)("a",{parentName:"p",href:"https://github.blog/2021-09-01-improving-git-protocol-security-github/"},"https://github.blog/2021-09-01-improving-git-protocol-security-github/"),"). Use an ",(0,i.kt)("inlineCode",{parentName:"p"},"https://")," URL if the source repository is hosted on Github."),(0,i.kt)("h4",{id:"building-an-image-using-a-url-to-an-archive"},"Building an image using a URL to an archive"),(0,i.kt)("p",null,"Podman will fetch the archive file, decompress it, and use its contents as the\nbuild context. The Containerfile at the root of the archive and the rest of the\narchive will get used as the context of the build. Passing the\n",(0,i.kt)("inlineCode",{parentName:"p"},"-f PATH/Containerfile")," option as well tells the system to look for that file\ninside the contents of the archive."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"$ podman build -f dev/Containerfile https://1000/podman/context.tar.gz\n")),(0,i.kt)("p",null,"Note: supported compression formats are 'xz', 'bzip2', 'gzip' and 'identity'\n(no compression)."),(0,i.kt)("h2",{id:"files"},"Files"),(0,i.kt)("h3",{id:"containerignoredockerignore"},".containerignore/.dockerignore"),(0,i.kt)("p",null,"If the file ",(0,i.kt)("em",{parentName:"p"},".containerignore")," or ",(0,i.kt)("em",{parentName:"p"},".dockerignore")," exists in the context directory,\n",(0,i.kt)("inlineCode",{parentName:"p"},"podman build")," reads its contents. Use the ",(0,i.kt)("inlineCode",{parentName:"p"},"--ignorefile")," option to override the\n.containerignore path location.\nPodman uses the content to exclude files and directories from the context\ndirectory, when executing COPY and ADD directives in the\nContainerfile/Dockerfile"),(0,i.kt)("p",null,"The .containerignore and .dockerignore files use the same syntax; if both\nare in the context directory, podman build will only use .containerignore."),(0,i.kt)("p",null,"Users can specify a series of Unix shell globs in a .containerignore file to\nidentify files/directories to exclude."),(0,i.kt)("p",null,"Podman supports a special wildcard string ",(0,i.kt)("inlineCode",{parentName:"p"},"**")," which matches any number of\ndirectories (including zero). For example, ","*",(0,i.kt)("em",{parentName:"p"},"/"),".go will exclude all files that\nend with .go that are found in all directories."),(0,i.kt)("p",null,"Example .containerignore file:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"# exclude this content for image\n*/*.c\n**/output*\nsrc\n")),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"*/*.c"),"\nExcludes files and directories whose names ends with .c in any top level\nsubdirectory. For example, the source file include/rootless.c."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"**/output*"),"\nExcludes files and directories starting with ",(0,i.kt)("inlineCode",{parentName:"p"},"output")," from any directory."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"src"),"\nExcludes files named src and the directory src as well as any content in it."),(0,i.kt)("p",null,"Lines starting with ! (exclamation mark) can be used to make exceptions to\nexclusions. The following is an example .containerignore file that uses this\nmechanism:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"*.doc\n!Help.doc\n")),(0,i.kt)("p",null,"Exclude all doc files except Help.doc from the image."),(0,i.kt)("p",null,"This functionality is compatible with the handling of .containerignore files\ndescribed here:"),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://github.com/containers/common/blob/main/docs/containerignore.5.md"},"https://github.com/containers/common/blob/main/docs/containerignore.5.md")),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},"registries.conf")," (",(0,i.kt)("inlineCode",{parentName:"p"},"/etc/containers/registries.conf"),")"),(0,i.kt)("p",null,"registries.conf is the configuration file which specifies which container\nregistries should be consulted when completing image names which do not include\na registry or domain portion."),(0,i.kt)("h2",{id:"troubleshooting"},"Troubleshooting"),(0,i.kt)("h3",{id:"lastlog-sparse-file"},"lastlog sparse file"),(0,i.kt)("p",null,"Using a useradd command within a Containerfile with a large UID/GID will create\na large sparse file ",(0,i.kt)("inlineCode",{parentName:"p"},"/var/log/lastlog"),". This can cause the\nbuild to hang forever. Go language does not support sparse files correctly,\nwhich can lead to some huge files being created in the container image."),(0,i.kt)("p",null,"When using the ",(0,i.kt)("inlineCode",{parentName:"p"},"useradd")," command within the build script, pass the\n",(0,i.kt)("inlineCode",{parentName:"p"},"--no-log-init or -l")," option to the ",(0,i.kt)("inlineCode",{parentName:"p"},"useradd")," command. This option tells\nuseradd to stop creating the lastlog file."),(0,i.kt)("h2",{id:"see-also"},"SEE ALSO"),(0,i.kt)("p",null,(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"/websites-new/docs/podman"},"podman(1)")),", ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"https://github.com/containers/buildah/blob/main/docs/buildah.1.md"},"buildah(1)")),", ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"https://github.com/containers/image/blob/main/docs/containers-certs.d.5.md"},"containers-certs.d(5)")),", ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"https://github.com/containers/image/blob/main/docs/containers-registries.conf.5.md"},"containers-registries.conf(5)")),", ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"https://github.com/containers/crun/blob/main/crun.1.md"},"crun(1)")),", ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"https://github.com/opencontainers/runc/blob/main/man/runc.8.md"},"runc(8)")),", ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"https://www.unix.com/man-page/redhat/8/useradd"},"useradd(8)")),", ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"/websites-new/docs/podman-ps"},"podman-ps(1)")),", ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"/websites-new/docs/podman-rm"},"podman-rm(1)")),", ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"https://github.com/containers/common/blob/main/docs/Containerfile.5.md"},"Containerfile(5)")),", ",(0,i.kt)("strong",{parentName:"p"},(0,i.kt)("a",{parentName:"strong",href:"https://github.com/containers/common/blob/main/docs/containerignore.5.md"},"containerignore(5)"))),(0,i.kt)("h2",{id:"history"},"HISTORY"),(0,i.kt)("p",null,"Aug 2020, Additional options and .containerignore added by Dan Walsh ",(0,i.kt)("inlineCode",{parentName:"p"},"<dwalsh@redhat.com>")),(0,i.kt)("p",null,"May 2018, Minor revisions added by Joe Doss ",(0,i.kt)("inlineCode",{parentName:"p"},"<joe@solidadmin.com>")),(0,i.kt)("p",null,"December 2017, Originally compiled by Tom Sweeney ",(0,i.kt)("inlineCode",{parentName:"p"},"<tsweeney@redhat.com>")),(0,i.kt)("h2",{id:"footnotes"},"FOOTNOTES"),(0,i.kt)("a",{name:"Footnote1"},"1"),": The Podman project is committed to inclusivity, a core value of open source. The `master` and `slave` mount propagation terminology used here is problematic and divisive, and should be changed. However, these terms are currently used within the Linux kernel and must be used as-is at this time. When the kernel maintainers rectify this usage, Podman will follow suit immediately.")}d.isMDXComponent=!0}}]);