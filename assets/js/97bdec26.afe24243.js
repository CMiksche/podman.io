"use strict";(self.webpackChunkpodman=self.webpackChunkpodman||[]).push([[98659],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>c});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function i(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),d=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},p=function(e){var t=d(e.components);return n.createElement(s.Provider,{value:t},e.children)},u="mdxType",k={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},m=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,p=i(e,["components","mdxType","originalType","parentName"]),u=d(a),m=r,c=u["".concat(s,".").concat(m)]||u[m]||k[m]||o;return a?n.createElement(c,l(l({ref:t},p),{},{components:a})):n.createElement(c,l({ref:t},p))}));function c(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,l=new Array(o);l[0]=m;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[u]="string"==typeof e?e:r,l[1]=i;for(var d=2;d<o;d++)l[d]=a[d];return n.createElement.apply(null,l)}return n.createElement.apply(null,a)}m.displayName="MDXCreateElement"},81149:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>l,default:()=>k,frontMatter:()=>o,metadata:()=>i,toc:()=>d});var n=a(87462),r=(a(67294),a(3905));const o={title:"Testing Podman 4 with the new network stack",layout:"default",author:"baude",categories:["blogs"],tags:["containers","podman","networking","pod","api","kubernetes","kube","v2","hpc","windows","mac","rootless","sudo","network","netavark","aardvark","aardvark-dns"]},l=void 0,i={permalink:"/blog/2022/02/04/network-usage",source:"@site/blog/2022-02-04-network-usage.md",title:"Testing Podman 4 with the new network stack",description:"podman logo",date:"2022-02-04T00:00:00.000Z",formattedDate:"February 4, 2022",tags:[{label:"containers",permalink:"/blog/tags/containers"},{label:"podman",permalink:"/blog/tags/podman"},{label:"networking",permalink:"/blog/tags/networking"},{label:"pod",permalink:"/blog/tags/pod"},{label:"api",permalink:"/blog/tags/api"},{label:"kubernetes",permalink:"/blog/tags/kubernetes"},{label:"kube",permalink:"/blog/tags/kube"},{label:"v2",permalink:"/blog/tags/v-2"},{label:"hpc",permalink:"/blog/tags/hpc"},{label:"windows",permalink:"/blog/tags/windows"},{label:"mac",permalink:"/blog/tags/mac"},{label:"rootless",permalink:"/blog/tags/rootless"},{label:"sudo",permalink:"/blog/tags/sudo"},{label:"network",permalink:"/blog/tags/network"},{label:"netavark",permalink:"/blog/tags/netavark"},{label:"aardvark",permalink:"/blog/tags/aardvark"},{label:"aardvark-dns",permalink:"/blog/tags/aardvark-dns"}],readingTime:1.465,hasTruncateMarker:!0,authors:[{name:"baude"}],frontMatter:{title:"Testing Podman 4 with the new network stack",layout:"default",author:"baude",categories:["blogs"],tags:["containers","podman","networking","pod","api","kubernetes","kube","v2","hpc","windows","mac","rootless","sudo","network","netavark","aardvark","aardvark-dns"]},prevItem:{title:"Podman v4.0.0 Released",permalink:"/blog/2022/02/22/new"},nextItem:{title:"Testing Podman 4 with new network stack",permalink:"/blog/2022/02/04/new"}},s={authorsImageUrls:[void 0]},d=[{value:"By Brent Baude GitHub",id:"by-brent-baude-github",level:2},{value:"Setting up Podman 4 with netavark and aardvark-dns on Fedora",id:"setting-up-podman-4-with-netavark-and-aardvark-dns-on-fedora",level:2}],p={toc:d},u="wrapper";function k(e){let{components:t,...o}=e;return(0,r.kt)(u,(0,n.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"podman logo",src:a(1382).Z,width:"228",height:"61"})),(0,r.kt)("h1",{id:"testing-podman-4-with-the-new-network-stack"},"Testing Podman 4 with the new network stack"),(0,r.kt)("h2",{id:"by-brent-baude-github"},"By Brent Baude ",(0,r.kt)("a",{parentName:"h2",href:"https://github.com/baude"},"GitHub")),(0,r.kt)("p",null,"Podman 4.0 will implement a new network stack instead of CNI plugins. There are two components to the new stack:"),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},"Netavark performs interface setup, IP address/etc assignment, NAT, and port mapping."),(0,r.kt)("li",{parentName:"ul"},"Aardvark-dns that replaces the previous DNS name custom plugin. Aardvark-dns is a DNS server that provides name resolution and forwarding for container networks.")),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},(0,r.kt)("strong",{parentName:"p"},"Warning"),": Before testing Podman 4 and the new network stack, you will have to destroy all your current containers, images, and network. Consider exporting/saving any import containers or images.")),(0,r.kt)("p",null,"If you have run Podman 3.x before upgrading to Podman 4, Podman will continue to use CNI plugins as it had before. There is a marker in Podman's local storage that indicates this. In order to begin using Podman 4, you need to destroy that marker with podman system reset. This will destroy the marker, all of the images, all of the networks, and all of the containers."),(0,r.kt)("h2",{id:"setting-up-podman-4-with-netavark-and-aardvark-dns-on-fedora"},"Setting up Podman 4 with netavark and aardvark-dns on Fedora"),(0,r.kt)("p",null,"If this is an upgrade to a current Podman install, destroy all current images, containers, and defined networks."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"$ podman system reset --force")),(0,r.kt)("p",null,"Ensure you have the DNF copr extension."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"$ sudo dnf install 'dnf-command(copr)'")),(0,r.kt)("p",null,"Add the podman4 test COPR to your system"),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"$ sudo dnf copr enable rhcontainerbot/podman4")),(0,r.kt)("p",null,"If you have never installed Podman, replace ",(0,r.kt)("inlineCode",{parentName:"p"},"upgrade")," with ",(0,r.kt)("inlineCode",{parentName:"p"},"install")," in the following command."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"$ sudo dnf upgrade podman")),(0,r.kt)("p",null,"If Podman was upgraded, you may have to install netavark explicitly. Otherwise, the Podman package will continue to use CNI."),(0,r.kt)("blockquote",null,(0,r.kt)("p",{parentName:"blockquote"},"$ sudo dnf install netavark aardvark-dns")),(0,r.kt)("p",null,"If you find bugs, please report them to our ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/containers/podman/issues"},"github issues page"),"."))}k.isMDXComponent=!0},1382:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/podman-ce586c2894883ad9c353492b5e1893a8.svg"}}]);